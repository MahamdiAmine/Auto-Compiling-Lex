#! /bin/bash

#============================================================================================================
#           Twitter:      https://twitter.com/mahamdi.amine
#           Github :      https://github.com/MahamdiAmine
#           Website:      https://mahamdiamine.github.io/
#============================================================================================================
yellow='\e[1;33m'
Red="\e[1;31m"
green='\e[0;34m'
Cclear="\e[0m"
dir=`pwd`
arg=$1
clear
Cname="$arg.c"
Oname="$arg.o"
#============================================================================================================


#============================================================================================================
#if [$# -ne 1]; then
if [ "$#" != "1" ]; then
	echo -e "${Red}       illegal number of parameters.$Cclear"
	echo
	exit 1
fi
#============================================================================================================


#============================================================================================================

#============================================================================================================
bar ()
{
	echo -n  Working on it  = =;
	sleep 0.5 & while [ "$(ps a | awk '{print $1}' | grep $!)" ] ; do for X in '-' '\' '|' '/'; do echo -en "\b$X"; sleep 0.1; done; done
  echo
	echo

	echo
BAR='█║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║█'

for i in {1..50}; do
    echo -ne "\r             ${BAR:0:$i}"
    sleep 0.006
done
echo
}
#============================================================================================================

#============================================================================================================
flex $arg
mv $dir/lex.yy.c $dir/$Cname
gcc $Cname -o $Oname -lfl
bar
clear
echo
echo -e $green "         Executing ... $Cclear"
sleep 1
clear
./$Oname


#============================================================================================================
